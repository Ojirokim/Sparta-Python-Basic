---
layout: post
title: "Day 12 - Studying analysis"
categories: [ til, python, SQL ]
---

# Day 12 ‚Äî Python & SQL

üìÖ 2026-01-19

Today is **Day 12 of my learning journey**.

This post is written mainly for myself, but it may also help other beginners.

---

#  Model Selection & Diagnostic Baseline Sheet
> **Purpose:** Choose the right model and know how to validate it  
> **Rule:** Start simple ‚Üí diagnose ‚Üí upgrade only if needed

---

## 1. Start With the Question (ALWAYS)
### What is the primary goal?

| Goal                              | Model Family            |
|-----------------------------------|-------------------------|
| Explain / infer / test hypotheses | Statistical models      |
| Predict as accurately as possible | Machine Learning models |
| Discover structure / patterns     | Unsupervised models     |
| Forecast over time                | Time series models      |

---

## 2. Supervised Models: When to Use What
### üîπ Continuous Target (Regression)

| Situation                    | Start With        | Upgrade To              |
|------------------------------|-------------------|-------------------------|
| Clean data, need explanation | Linear Regression | Robust / Transformed LR |
| Nonlinear patterns           | Decision Tree     | Random Forest           |
| High accuracy needed         | Random Forest     | Gradient Boosting       |
| Heteroscedastic data         | Log-Linear Model  | WLS / Robust SE         |

---

### üîπ Binary Target (Classification)

| Situation               | Start With          | Upgrade To        |
|-------------------------|---------------------|-------------------|
| Interpretability needed | Logistic Regression | ‚Äî                 |
| Messy / nonlinear       | Decision Tree       | Random Forest     |
| Best performance        | Random Forest       | Gradient Boosting |

---

### üîπ Multiclass Target

| Situation                | Model                |
|--------------------------|----------------------|
| Explain class effects    | Multinomial Logistic |
| Nonlinear / interactions | Decision Tree        |
| High accuracy            | Random Forest        |

---

### üîπ Count Data

| Situation                | Model              |
|--------------------------|--------------------|
| Low counts, theory-based | Poisson Regression |
| Overdispersion           | Negative Binomial  |
| Messy / nonlinear        | Tree-based models  |

---

## 3. Time-Based Data

| Situation               | Model                |
|-------------------------|----------------------|
| Pure time dependence    | ARIMA / SARIMA       |
| Seasonality + trend     | SARIMA               |
| Complex patterns        | ML with lag features |
| Interpretability needed | State-space models   |

---

## 4. Unsupervised Learning

| Goal                       | Model                   |
|----------------------------|-------------------------|
| Group similar observations | K-means                 |
| Hierarchical grouping      | Hierarchical Clustering |
| Reduce dimensions          | PCA                     |

---

## 5. Post-Model Diagnostics (CRITICAL)
### üîπ Linear Regression & GLMs
**Required diagnostics:**

| Check                     | Tool                | What It Tells You     |
|---------------------------|---------------------|-----------------------|
| Linearity                 | Residuals vs Fitted | Wrong functional form |
| Homoscedasticity          | Residual spread     | Variance stability    |
| Normality (for inference) | Histogram / Q‚ÄìQ     | Valid p-values & CIs  |
| Independence              | Residuals vs time   | Autocorrelation       |
| Outliers                  | Std. residuals      | Data issues           |
| Influence                 | Cook‚Äôs distance     | Dominating points     |

**If violated:**
- Transform target (log, sqrt)
- Add nonlinear terms / interactions
- Use robust standard errors
- Switch model family

---

### üîπ Decision Trees

**Diagnostics:**
- Training vs validation error
- Tree depth
- Feature importance stability

**Failure modes:**
- Overfitting
- High variance

**Fixes:**
- Pruning
- Minimum samples per leaf
- Switch to Random Forest

---

### üîπ Random Forest / Boosting

**Diagnostics:**
- Cross-validation error
- Feature importance
- Residual error patterns (bias detection)

**Not required:**
- Normality of residuals
- Classical p-values

---

### üîπ Time Series Models

**Required diagnostics:**
| Check                 | Tool                    |
|-----------------------|-------------------------|
| Autocorrelation       | ACF / PACF of residuals |
| Remaining seasonality | Residual plots          |
| Stationarity          | Unit root tests         |
| White noise           | Residual randomness     |

---

## 6. Model Evaluation: What Metric to Trust

| Model Type         | Main Evaluation                    |
|--------------------|------------------------------------|
| Statistical models | Residual diagnostics + p-values    |
| ML regression      | RMSE / MAE / CV                    |
| ML classification  | Accuracy / ROC / F1                |
| Time series        | Forecast error + residual autocorr |

---

## 7. Professional Default Workflow

```text
1. Define goal (explain vs predict)
2. Start with simplest reasonable model
3. Fit model
4. Diagnose assumptions / errors
5. Fix or upgrade model
6. Validate on new data
7. Interpret or deploy
```


# Datetime with map()
```python
df["weekday_en"] = df["date"].dt.day_name()
weekday_map = {
    "Monday": "Ïõî", "Tuesday": "Ìôî", "Wednesday": "Ïàò",
    "Thursday": "Î™©", "Friday": "Í∏à", "Saturday": "ÌÜ†", "Sunday": "Ïùº"
}
df["weekday"] = df["weekday_en"].map(weekday_map)
```
Looks at each value in weekday_en
Uses it as a key in weekday_map
Replaces it with the corresponding value

"Monday"    ‚Üí "Ïõî"
"Tuesday"   ‚Üí "Ìôî"
‚Äª If weekday_en contains a value not in the dictionary, it will be replaced with NaN