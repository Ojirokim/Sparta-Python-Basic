---
layout: post
title: "Day 13 - Studying analysis"
categories: [ til, python, SQL ]
---

# Day 13 â€” Python & SQL

ðŸ“… 2026-01-20

Today is **Day 13 of my learning journey**.

This post is written mainly for myself, but it may also help other beginners.

---

## 1. Why `pd.to_numeric()` is followed by `.astype(int)`

Tutorâ€™s code:

```python
df["qty"] = pd.to_numeric(df["qty"], errors="coerce")
df["qty"] = df["qty"].fillna(1)
df["qty"] = df["qty"].astype(int)
```
Key points
pd.to_numeric() Converts values to numbers.
Invalid values become NaN when errors="coerce".
Result is usually float, not int, because floats can represent NaN.
.fillna(1): Replaces missing values (NaN) using a business rule (default quantity = 1).
.astype(int): Forces the column to be true integers.
Can only be done after all NaNs are removed.

## 2. What the to_bool() function does
Code:
```python
Copy code
def to_bool(x):
    if isinstance(x, bool):
        return x
    x = str(x).strip().lower()
    return x in ["true", "1", "yes", "y"]
```
Purpose
Convert messy, real-world values into clean True / False.

## 3. isinstance()
â€œIs this value already a True or False?â€
- Why itâ€™s used
If the value is already a boolean, return it unchanged.
Prevents unnecessary or confusing conversions.
Safer than checking types manually.
Example:
```python
Copy code
isinstance(True, bool)   # True
isinstance("true", bool) # False
```

## 4. Common â€œis-somethingâ€ checks youâ€™ll see a lot
- isinstance(x, type)
Check what type something is.

- Series.isin([...]) (pandas)
Check if values are in a list.

- pd.isna(x) / pd.notna(x)
Check for missing data.

- hasattr(x, "attr")
Check if an object has something before using it.

- Golden rule:
If it starts with is, it usually answers a yes/no question.

## 5. Why .apply(to_bool) and NOT to_bool()
df.apply(tool(or function), axis=0 or 1)

Code example:
```python
df["paid"] = df["paid"].apply(to_bool)
```
Key idea
to_bool â†’ the function itself
to_bool() â†’ running the function immediately gets the result
.apply() needs the function, not the result.

What .apply() does internally
```python
for value in df["paid"]:
    to_bool(value)
```
So pandas supplies the value â€” you donâ€™t.


## What `np.where()` is
`np.where()` is a NumPy function used to **choose values based on a condition**.  
Think of it as a **vectorized ifâ€“else** that works on arrays or pandas Series.

### Basic form
```python
np.where(condition, value_if_true, value_if_false)
condition â†’ array-like of True / False
```
value_if_true â†’ value to use where condition is True
value_if_false â†’ value to use where condition is False

Simple example
```python
import numpy as np
x = np.array([1, 2, 3, 4])
np.where(x > 2, "big", "small")

# Result
['small', 'small', 'big', 'big']
```
### With pandas Series (very common)
```python
df["paid_label"] = np.where(df["paid"], "Paid", "Unpaid")
```
True â†’ "Paid"
False â†’ "Unpaid"

â€» Why itâ€™s useful
Replaces many if/else statements
Faster than .apply()
Works on whole columns at once
Very common in pandas + NumPy workflows

### Boolean logic example
```python
df["status"] = np.where(
    df["amount"] > 0,
    "positive",
    "zero or negative"
)
```
Equivalent Python logic (for understanding)
```python
result = []
for x in values:
    if condition:
        result.append(value_if_true)
    else:
        result.append(value_if_false)
```
np.where() does this without a loop.

### Special case: only one argument
```python
np.where(condition)
```
Returns the indices where condition is True.

Example:
```python
np.where([True, False, True])

#Result:
(array([0, 2]),)
```

### Common mistakes
Using it when pandas already has a method
Forgetting value_if_false
Mixing incompatible data types